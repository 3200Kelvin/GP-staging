(()=>{"use strict";const e=({trigger:e=null,xProperty:n="offsetX",yProperty:r="offsetY",splatRadius:t=.2}={})=>{const i=document.querySelector(".smoke-sim canvas");i.width=i.clientWidth,i.height=i.clientHeight;const o=e||i;let u={SIM_RESOLUTION:128,DYE_RESOLUTION:512,DENSITY_DISSIPATION:.97,VELOCITY_DISSIPATION:.98,PRESSURE_DISSIPATION:.8,PRESSURE_ITERATIONS:20,CURL:5,SPLAT_RADIUS:t,SHADING:!0,COLORFUL:!0,PAUSED:!1,BACK_COLOR:{r:0,g:0,b:0},TRANSPARENT:!1,BLOOM:!0,BLOOM_ITERATIONS:8,BLOOM_RESOLUTION:256,BLOOM_INTENSITY:.8,BLOOM_THRESHOLD:.6,BLOOM_SOFT_KNEE:.7},a=[],l=[];a.push(new function(){this.id=-1,this.x=0,this.y=0,this.dx=0,this.dy=0,this.down=!1,this.moved=!1,this.color=[30,0,300]});const{gl:v,ext:c}=function(e){const n={alpha:!0,depth:!1,stencil:!1,antialias:!1,preserveDrawingBuffer:!1};let r=e.getContext("webgl2",n);const t=!!r;let i,o;t||(r=e.getContext("webgl",n)||e.getContext("experimental-webgl",n)),t?(r.getExtension("EXT_color_buffer_float"),o=r.getExtension("OES_texture_float_linear")):(i=r.getExtension("OES_texture_half_float"),o=r.getExtension("OES_texture_half_float_linear")),r.clearColor(0,0,0,1);const u=t?r.HALF_FLOAT:i.HALF_FLOAT_OES;let a,l,v;return t?(a=s(r,r.RGBA16F,r.RGBA,u),l=s(r,r.RG16F,r.RG,u),v=s(r,r.R16F,r.RED,u)):(a=s(r,r.RGBA,r.RGBA,u),l=s(r,r.RGBA,r.RGBA,u),v=s(r,r.RGBA,r.RGBA,u)),{gl:r,ext:{formatRGBA:a,formatRG:l,formatR:v,halfFloatTexType:u,supportLinearFiltering:o}}}(i);function s(e,n,r,t){if(!function(e,n,r,t){let i=e.createTexture();e.bindTexture(e.TEXTURE_2D,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texImage2D(e.TEXTURE_2D,0,n,4,4,0,r,t,null);let o=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,o),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,i,0);return e.checkFramebufferStatus(e.FRAMEBUFFER)==e.FRAMEBUFFER_COMPLETE}(e,n,r,t))switch(n){case e.R16F:return s(e,e.RG16F,e.RG,t);case e.RG16F:return s(e,e.RGBA16F,e.RGBA,t);default:return null}return{internalFormat:n,format:r}}/Mobi|Android/i.test(navigator.userAgent)&&(u.SHADING=!1),c.supportLinearFiltering||(u.SHADING=!1,u.BLOOM=!1);class f{constructor(e,n){if(this.uniforms={},this.program=v.createProgram(),v.attachShader(this.program,e),v.attachShader(this.program,n),v.linkProgram(this.program),!v.getProgramParameter(this.program,v.LINK_STATUS))throw v.getProgramInfoLog(this.program);const r=v.getProgramParameter(this.program,v.ACTIVE_UNIFORMS);for(let e=0;e<r;e++){const n=v.getActiveUniform(this.program,e).name;this.uniforms[n]=v.getUniformLocation(this.program,n)}}bind(){v.useProgram(this.program)}}function m(e,n){const r=v.createShader(e);if(v.shaderSource(r,n),v.compileShader(r),!v.getShaderParameter(r,v.COMPILE_STATUS))throw v.getShaderInfoLog(r);return r}const g=m(v.VERTEX_SHADER,"\n        precision highp float;\n        attribute vec2 aPosition;\n        varying vec2 vUv;\n        varying vec2 vL;\n        varying vec2 vR;\n        varying vec2 vT;\n        varying vec2 vB;\n        uniform vec2 texelSize;\n        void main () {\n            vUv = aPosition * 0.5 + 0.5;\n            vL = vUv - vec2(texelSize.x, 0.0);\n            vR = vUv + vec2(texelSize.x, 0.0);\n            vT = vUv + vec2(0.0, texelSize.y);\n            vB = vUv - vec2(0.0, texelSize.y);\n            gl_Position = vec4(aPosition, 0.0, 1.0);\n        }\n    "),d=m(v.FRAGMENT_SHADER,"\n        precision mediump float;\n        precision mediump sampler2D;\n        varying highp vec2 vUv;\n        uniform sampler2D uTexture;\n        uniform float value;\n        void main () {\n            gl_FragColor = value * texture2D(uTexture, vUv);\n        }\n    "),T=m(v.FRAGMENT_SHADER,"\n        precision mediump float;\n        uniform vec4 color;\n        void main () {\n            gl_FragColor = color;\n        }\n    "),h=m(v.FRAGMENT_SHADER,"\n        precision highp float;\n        precision highp sampler2D;\n        varying vec2 vUv;\n        uniform sampler2D uTexture;\n        uniform float aspectRatio;\n        #define SCALE 25.0\n        void main () {\n            vec2 uv = floor(vUv * SCALE * vec2(aspectRatio, 1.0));\n            float v = mod(uv.x + uv.y, 2.0);\n            v = v * 0.1 + 0.8;\n            gl_FragColor = vec4(vec3(v), 1.0);\n        }\n    "),E=m(v.FRAGMENT_SHADER,"\n        precision highp float;\n        precision highp sampler2D;\n        varying vec2 vUv;\n        uniform sampler2D uTexture;\n        void main () {\n            vec3 C = texture2D(uTexture, vUv).rgb;\n            float a = max(C.r, max(C.g, C.b));\n            gl_FragColor = vec4(C, a);\n        }\n    "),p=m(v.FRAGMENT_SHADER,"\n        precision highp float;\n        precision highp sampler2D;\n        varying vec2 vUv;\n        uniform sampler2D uTexture;\n        uniform sampler2D uBloom;\n        uniform sampler2D uDithering;\n        uniform vec2 ditherScale;\n        void main () {\n            vec3 C = texture2D(uTexture, vUv).rgb;\n            vec3 bloom = texture2D(uBloom, vUv).rgb;\n            vec3 noise = texture2D(uDithering, vUv * ditherScale).rgb;\n            noise = noise * 2.0 - 1.0;\n            bloom += noise / 800.0;\n            bloom = pow(bloom.rgb, vec3(1.0 / 2.2));\n            C += bloom;\n            float a = max(C.r, max(C.g, C.b));\n            gl_FragColor = vec4(C, a);\n        }\n    "),R=m(v.FRAGMENT_SHADER,"\n        precision highp float;\n        precision highp sampler2D;\n        varying vec2 vUv;\n        varying vec2 vL;\n        varying vec2 vR;\n        varying vec2 vT;\n        varying vec2 vB;\n        uniform sampler2D uTexture;\n        uniform vec2 texelSize;\n        void main () {\n            vec3 L = texture2D(uTexture, vL).rgb;\n            vec3 R = texture2D(uTexture, vR).rgb;\n            vec3 T = texture2D(uTexture, vT).rgb;\n            vec3 B = texture2D(uTexture, vB).rgb;\n            vec3 C = texture2D(uTexture, vUv).rgb;\n            float dx = length(R) - length(L);\n            float dy = length(T) - length(B);\n            vec3 n = normalize(vec3(dx, dy, length(texelSize)));\n            vec3 l = vec3(0.0, 0.0, 1.0);\n            float diffuse = clamp(dot(n, l) + 0.7, 0.7, 1.0);\n            C.rgb *= diffuse;\n            float a = max(C.r, max(C.g, C.b));\n            gl_FragColor = vec4(C, a);\n        }\n    "),x=m(v.FRAGMENT_SHADER,"\n        precision highp float;\n        precision highp sampler2D;\n        varying vec2 vUv;\n        varying vec2 vL;\n        varying vec2 vR;\n        varying vec2 vT;\n        varying vec2 vB;\n        uniform sampler2D uTexture;\n        uniform sampler2D uBloom;\n        uniform sampler2D uDithering;\n        uniform vec2 ditherScale;\n        uniform vec2 texelSize;\n        void main () {\n            vec3 L = texture2D(uTexture, vL).rgb;\n            vec3 R = texture2D(uTexture, vR).rgb;\n            vec3 T = texture2D(uTexture, vT).rgb;\n            vec3 B = texture2D(uTexture, vB).rgb;\n            vec3 C = texture2D(uTexture, vUv).rgb;\n            float dx = length(R) - length(L);\n            float dy = length(T) - length(B);\n            vec3 n = normalize(vec3(dx, dy, length(texelSize)));\n            vec3 l = vec3(0.0, 0.0, 1.0);\n            float diffuse = clamp(dot(n, l) + 0.7, 0.7, 1.0);\n            C *= diffuse;\n            vec3 bloom = texture2D(uBloom, vUv).rgb;\n            vec3 noise = texture2D(uDithering, vUv * ditherScale).rgb;\n            noise = noise * 2.0 - 1.0;\n            bloom += noise / 800.0;\n            bloom = pow(bloom.rgb, vec3(1.0 / 2.2));\n            C += bloom;\n            float a = max(C.r, max(C.g, C.b));\n            gl_FragColor = vec4(C, a);\n        }\n    "),D=m(v.FRAGMENT_SHADER,"\n        precision mediump float;\n        precision mediump sampler2D;\n        varying vec2 vUv;\n        uniform sampler2D uTexture;\n        uniform vec3 curve;\n        uniform float threshold;\n        void main () {\n            vec3 c = texture2D(uTexture, vUv).rgb;\n            float br = max(c.r, max(c.g, c.b));\n            float rq = clamp(br - curve.x, 0.0, curve.y);\n            rq = curve.z * rq * rq;\n            c *= max(rq, br - threshold) / max(br, 0.0001);\n            gl_FragColor = vec4(c, 0.0);\n        }\n    "),y=m(v.FRAGMENT_SHADER,"\n        precision mediump float;\n        precision mediump sampler2D;\n        varying vec2 vL;\n        varying vec2 vR;\n        varying vec2 vT;\n        varying vec2 vB;\n        uniform sampler2D uTexture;\n        void main () {\n            vec4 sum = vec4(0.0);\n            sum += texture2D(uTexture, vL);\n            sum += texture2D(uTexture, vR);\n            sum += texture2D(uTexture, vT);\n            sum += texture2D(uTexture, vB);\n            sum *= 0.25;\n            gl_FragColor = sum;\n        }\n    "),_=m(v.FRAGMENT_SHADER,"\n        precision mediump float;\n        precision mediump sampler2D;\n        varying vec2 vL;\n        varying vec2 vR;\n        varying vec2 vT;\n        varying vec2 vB;\n        uniform sampler2D uTexture;\n        uniform float intensity;\n        void main () {\n            vec4 sum = vec4(0.0);\n            sum += texture2D(uTexture, vL);\n            sum += texture2D(uTexture, vR);\n            sum += texture2D(uTexture, vT);\n            sum += texture2D(uTexture, vB);\n            sum *= 0.25;\n            gl_FragColor = sum * intensity;\n        }\n    "),S=m(v.FRAGMENT_SHADER,"\n        precision highp float;\n        precision highp sampler2D;\n        varying vec2 vUv;\n        uniform sampler2D uTarget;\n        uniform float aspectRatio;\n        uniform vec3 color;\n        uniform vec2 point;\n        uniform float radius;\n        void main () {\n            vec2 p = vUv - point.xy;\n            p.x *= aspectRatio;\n            vec3 splat = exp(-dot(p, p) / radius) * color;\n            vec3 base = texture2D(uTarget, vUv).xyz;\n            gl_FragColor = vec4(base + splat, 1.0);\n        }\n    "),b=m(v.FRAGMENT_SHADER,"\n        precision highp float;\n        precision highp sampler2D;\n        varying vec2 vUv;\n        uniform sampler2D uVelocity;\n        uniform sampler2D uSource;\n        uniform vec2 texelSize;\n        uniform vec2 dyeTexelSize;\n        uniform float dt;\n        uniform float dissipation;\n        vec4 bilerp (sampler2D sam, vec2 uv, vec2 tsize) {\n            vec2 st = uv / tsize - 0.5;\n            vec2 iuv = floor(st);\n            vec2 fuv = fract(st);\n            vec4 a = texture2D(sam, (iuv + vec2(0.5, 0.5)) * tsize);\n            vec4 b = texture2D(sam, (iuv + vec2(1.5, 0.5)) * tsize);\n            vec4 c = texture2D(sam, (iuv + vec2(0.5, 1.5)) * tsize);\n            vec4 d = texture2D(sam, (iuv + vec2(1.5, 1.5)) * tsize);\n            return mix(mix(a, b, fuv.x), mix(c, d, fuv.x), fuv.y);\n        }\n        void main () {\n            vec2 coord = vUv - dt * bilerp(uVelocity, vUv, texelSize).xy * texelSize;\n            gl_FragColor = dissipation * bilerp(uSource, coord, dyeTexelSize);\n            gl_FragColor.a = 1.0;\n        }\n    "),A=m(v.FRAGMENT_SHADER,"\n        precision highp float;\n        precision highp sampler2D;\n        varying vec2 vUv;\n        uniform sampler2D uVelocity;\n        uniform sampler2D uSource;\n        uniform vec2 texelSize;\n        uniform float dt;\n        uniform float dissipation;\n        void main () {\n            vec2 coord = vUv - dt * texture2D(uVelocity, vUv).xy * texelSize;\n            gl_FragColor = dissipation * texture2D(uSource, coord);\n            gl_FragColor.a = 1.0;\n        }\n    "),L=m(v.FRAGMENT_SHADER,"\n        precision mediump float;\n        precision mediump sampler2D;\n        varying highp vec2 vUv;\n        varying highp vec2 vL;\n        varying highp vec2 vR;\n        varying highp vec2 vT;\n        varying highp vec2 vB;\n        uniform sampler2D uVelocity;\n        void main () {\n            float L = texture2D(uVelocity, vL).x;\n            float R = texture2D(uVelocity, vR).x;\n            float T = texture2D(uVelocity, vT).y;\n            float B = texture2D(uVelocity, vB).y;\n            vec2 C = texture2D(uVelocity, vUv).xy;\n            if (vL.x < 0.0) { L = -C.x; }\n            if (vR.x > 1.0) { R = -C.x; }\n            if (vT.y > 1.0) { T = -C.y; }\n            if (vB.y < 0.0) { B = -C.y; }\n            float div = 0.5 * (R - L + T - B);\n            gl_FragColor = vec4(div, 0.0, 0.0, 1.0);\n        }\n    "),U=m(v.FRAGMENT_SHADER,"\n        precision mediump float;\n        precision mediump sampler2D;\n        varying highp vec2 vUv;\n        varying highp vec2 vL;\n        varying highp vec2 vR;\n        varying highp vec2 vT;\n        varying highp vec2 vB;\n        uniform sampler2D uVelocity;\n        void main () {\n            float L = texture2D(uVelocity, vL).y;\n            float R = texture2D(uVelocity, vR).y;\n            float T = texture2D(uVelocity, vT).x;\n            float B = texture2D(uVelocity, vB).x;\n            float vorticity = R - L - T + B;\n            gl_FragColor = vec4(0.5 * vorticity, 0.0, 0.0, 1.0);\n        }\n    "),F=m(v.FRAGMENT_SHADER,"\n        precision highp float;\n        precision highp sampler2D;\n        varying vec2 vUv;\n        varying vec2 vL;\n        varying vec2 vR;\n        varying vec2 vT;\n        varying vec2 vB;\n        uniform sampler2D uVelocity;\n        uniform sampler2D uCurl;\n        uniform float curl;\n        uniform float dt;\n        void main () {\n            float L = texture2D(uCurl, vL).x;\n            float R = texture2D(uCurl, vR).x;\n            float T = texture2D(uCurl, vT).x;\n            float B = texture2D(uCurl, vB).x;\n            float C = texture2D(uCurl, vUv).x;\n            vec2 force = 0.5 * vec2(abs(T) - abs(B), abs(R) - abs(L));\n            force /= length(force) + 0.0001;\n            force *= curl * C;\n            force.y *= -1.0;\n            vec2 vel = texture2D(uVelocity, vUv).xy;\n            gl_FragColor = vec4(vel + force * dt, 0.0, 1.0);\n        }\n    "),B=m(v.FRAGMENT_SHADER,"\n        precision mediump float;\n        precision mediump sampler2D;\n        varying highp vec2 vUv;\n        varying highp vec2 vL;\n        varying highp vec2 vR;\n        varying highp vec2 vT;\n        varying highp vec2 vB;\n        uniform sampler2D uPressure;\n        uniform sampler2D uDivergence;\n        vec2 boundary (vec2 uv) {\n            return uv;\n            // uncomment if you use wrap or repeat texture mode\n            // uv = min(max(uv, 0.0), 1.0);\n            // return uv;\n        }\n        void main () {\n            float L = texture2D(uPressure, boundary(vL)).x;\n            float R = texture2D(uPressure, boundary(vR)).x;\n            float T = texture2D(uPressure, boundary(vT)).x;\n            float B = texture2D(uPressure, boundary(vB)).x;\n            float C = texture2D(uPressure, vUv).x;\n            float divergence = texture2D(uDivergence, vUv).x;\n            float pressure = (L + R + B + T - divergence) * 0.25;\n            gl_FragColor = vec4(pressure, 0.0, 0.0, 1.0);\n        }\n    "),w=m(v.FRAGMENT_SHADER,"\n        precision mediump float;\n        precision mediump sampler2D;\n        varying highp vec2 vUv;\n        varying highp vec2 vL;\n        varying highp vec2 vR;\n        varying highp vec2 vT;\n        varying highp vec2 vB;\n        uniform sampler2D uPressure;\n        uniform sampler2D uVelocity;\n        vec2 boundary (vec2 uv) {\n            return uv;\n            // uv = min(max(uv, 0.0), 1.0);\n            // return uv;\n        }\n        void main () {\n            float L = texture2D(uPressure, boundary(vL)).x;\n            float R = texture2D(uPressure, boundary(vR)).x;\n            float T = texture2D(uPressure, boundary(vT)).x;\n            float B = texture2D(uPressure, boundary(vB)).x;\n            vec2 velocity = texture2D(uVelocity, vUv).xy;\n            velocity.xy -= vec2(R - L, T - B);\n            gl_FragColor = vec4(velocity, 0.0, 1.0);\n        }\n    "),O=(v.bindBuffer(v.ARRAY_BUFFER,v.createBuffer()),v.bufferData(v.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),v.STATIC_DRAW),v.bindBuffer(v.ELEMENT_ARRAY_BUFFER,v.createBuffer()),v.bufferData(v.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,0,2,3]),v.STATIC_DRAW),v.vertexAttribPointer(0,2,v.FLOAT,!1,0,0),v.enableVertexAttribArray(0),e=>{v.bindFramebuffer(v.FRAMEBUFFER,e),v.drawElements(v.TRIANGLES,6,v.UNSIGNED_SHORT,0)});let C,N,I,P,M,G,X,H,z,V,Y=function(){let e=v.createTexture();v.bindTexture(v.TEXTURE_2D,e),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,v.LINEAR),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,v.LINEAR),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,v.REPEAT),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,v.REPEAT),v.texImage2D(v.TEXTURE_2D,0,v.RGB,1,1,0,v.RGB,v.UNSIGNED_BYTE,new Uint8Array([255,255,255]));let n={texture:e,width:1,height:1,attach:n=>(v.activeTexture(v.TEXTURE0+n),v.bindTexture(v.TEXTURE_2D,e),n)},r=new Image;return r.onload=()=>{n.width=r.width,n.height=r.height,v.bindTexture(v.TEXTURE_2D,e),v.texImage2D(v.TEXTURE_2D,0,v.RGB,v.RGB,v.UNSIGNED_BYTE,r)},r.src="LDR_RGB1_0.png",n}();const W=new f(g,d),k=new f(g,T),q=new f(g,h),K=new f(g,E),$=new f(g,p),j=new f(g,R),J=new f(g,x),Q=new f(g,D),Z=new f(g,y),ee=new f(g,_),ne=new f(g,S),re=new f(g,c.supportLinearFiltering?A:b),te=new f(g,L),ie=new f(g,U),oe=new f(g,F),ue=new f(g,B),ae=new f(g,w);function le(){let e=ge(u.SIM_RESOLUTION),n=ge(u.DYE_RESOLUTION);C=e.width,N=e.height,I=n.width,P=n.height;const r=c.halfFloatTexType,t=c.formatRGBA,i=c.formatRG,o=c.formatR,a=c.supportLinearFiltering?v.LINEAR:v.NEAREST;M=null==M?ce(I,P,t.internalFormat,t.format,r,a):se(M,I,P,t.internalFormat,t.format,r,a),G=null==G?ce(C,N,i.internalFormat,i.format,r,a):se(G,C,N,i.internalFormat,i.format,r,a),X=ve(C,N,o.internalFormat,o.format,r,v.NEAREST),H=ve(C,N,o.internalFormat,o.format,r,v.NEAREST),z=ce(C,N,o.internalFormat,o.format,r,v.NEAREST),function(){let e=ge(u.BLOOM_RESOLUTION);const n=c.halfFloatTexType,r=c.formatRGBA,t=c.supportLinearFiltering?v.LINEAR:v.NEAREST;V=ve(e.width,e.height,r.internalFormat,r.format,n,t),l.length=0;for(let i=0;i<u.BLOOM_ITERATIONS;i++){let o=e.width>>i+1,u=e.height>>i+1;if(o<2||u<2)break;let a=ve(o,u,r.internalFormat,r.format,n,t);l.push(a)}}()}function ve(e,n,r,t,i,o){v.activeTexture(v.TEXTURE0);let u=v.createTexture();v.bindTexture(v.TEXTURE_2D,u),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,o),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,o),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,v.CLAMP_TO_EDGE),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,v.CLAMP_TO_EDGE),v.texImage2D(v.TEXTURE_2D,0,r,e,n,0,t,i,null);let a=v.createFramebuffer();return v.bindFramebuffer(v.FRAMEBUFFER,a),v.framebufferTexture2D(v.FRAMEBUFFER,v.COLOR_ATTACHMENT0,v.TEXTURE_2D,u,0),v.viewport(0,0,e,n),v.clear(v.COLOR_BUFFER_BIT),{texture:u,fbo:a,width:e,height:n,attach:e=>(v.activeTexture(v.TEXTURE0+e),v.bindTexture(v.TEXTURE_2D,u),e)}}function ce(e,n,r,t,i,o){let u=ve(e,n,r,t,i,o),a=ve(e,n,r,t,i,o);return{get read(){return u},set read(e){u=e},get write(){return a},set write(e){a=e},swap(){let e=u;u=a,a=e}}}function se(e,n,r,t,i,o,u){return e.read=function(e,n,r,t,i,o,u){let a=ve(n,r,t,i,o,u);return W.bind(),v.uniform1i(W.uniforms.uTexture,e.attach(0)),v.uniform1f(W.uniforms.value,1),O(a.fbo),a}(e.read,n,r,t,i,o,u),e.write=ve(n,r,t,i,o,u),e}le();let fe=Date.now();function me(e=!1){let n=e?{r:1,g:.3,b:.24}:function(e){let n,r,t,i,o,u,a,l;switch(i=Math.floor(6*e),o=6*e-i,u=0,a=1*(1-1*o),l=1*(1-1*(1-o)),i%6){case 0:n=1,r=l,t=0;break;case 1:n=a,r=1,t=0;break;case 2:n=0,r=1,t=l;break;case 3:n=0,r=a,t=1;break;case 4:n=l,r=0,t=1;break;case 5:n=1,r=0,t=a}return{r:n,g:r,b:t}}(Math.random());return n.r*=.15,n.g*=.15,n.b*=.15,n}function ge(e){let n=v.drawingBufferWidth/v.drawingBufferHeight;n<1&&(n=1/n);let r=Math.round(e*n),t=Math.round(e);return v.drawingBufferWidth>v.drawingBufferHeight?{width:r,height:t}:{width:t,height:r}}function de(e,n,r){return{x:n/e.width,y:r/e.height}}!function e(){i.width==i.clientWidth&&i.height==i.clientHeight||(i.width=i.clientWidth,i.height=i.clientHeight,le()),function(){const e=a[0];var n,r,t,o,l;e.moved&&(n=e.x,r=e.y,t=e.dx,o=e.dy,l=e.color,v.viewport(0,0,C,N),ne.bind(),v.uniform1i(ne.uniforms.uTarget,G.read.attach(0)),v.uniform1f(ne.uniforms.aspectRatio,i.width/i.height),v.uniform2f(ne.uniforms.point,n/i.width,1-r/i.height),v.uniform3f(ne.uniforms.color,t,-o,1),v.uniform1f(ne.uniforms.radius,u.SPLAT_RADIUS/100),O(G.write.fbo),G.swap(),v.viewport(0,0,I,P),v.uniform1i(ne.uniforms.uTarget,M.read.attach(0)),v.uniform3f(ne.uniforms.color,l.r,l.g,l.b),O(M.write.fbo),M.swap(),e.moved=!1),u.COLORFUL&&fe+100<Date.now()&&(fe=Date.now(),a[0].color=me(!0))}(),u.PAUSED||function(){v.disable(v.BLEND),v.viewport(0,0,C,N),ie.bind(),v.uniform2f(ie.uniforms.texelSize,1/C,1/N),v.uniform1i(ie.uniforms.uVelocity,G.read.attach(0)),O(H.fbo),oe.bind(),v.uniform2f(oe.uniforms.texelSize,1/C,1/N),v.uniform1i(oe.uniforms.uVelocity,G.read.attach(0)),v.uniform1i(oe.uniforms.uCurl,H.attach(1)),v.uniform1f(oe.uniforms.curl,u.CURL),v.uniform1f(oe.uniforms.dt,.016),O(G.write.fbo),G.swap(),te.bind(),v.uniform2f(te.uniforms.texelSize,1/C,1/N),v.uniform1i(te.uniforms.uVelocity,G.read.attach(0)),O(X.fbo),W.bind(),v.uniform1i(W.uniforms.uTexture,z.read.attach(0)),v.uniform1f(W.uniforms.value,u.PRESSURE_DISSIPATION),O(z.write.fbo),z.swap(),ue.bind(),v.uniform2f(ue.uniforms.texelSize,1/C,1/N),v.uniform1i(ue.uniforms.uDivergence,X.attach(0));for(let e=0;e<u.PRESSURE_ITERATIONS;e++)v.uniform1i(ue.uniforms.uPressure,z.read.attach(1)),O(z.write.fbo),z.swap();ae.bind(),v.uniform2f(ae.uniforms.texelSize,1/C,1/N),v.uniform1i(ae.uniforms.uPressure,z.read.attach(0)),v.uniform1i(ae.uniforms.uVelocity,G.read.attach(1)),O(G.write.fbo),G.swap(),re.bind(),v.uniform2f(re.uniforms.texelSize,1/C,1/N),c.supportLinearFiltering||v.uniform2f(re.uniforms.dyeTexelSize,1/C,1/N);let e=G.read.attach(0);v.uniform1i(re.uniforms.uVelocity,e),v.uniform1i(re.uniforms.uSource,e),v.uniform1f(re.uniforms.dt,.016),v.uniform1f(re.uniforms.dissipation,u.VELOCITY_DISSIPATION),O(G.write.fbo),G.swap(),v.viewport(0,0,I,P),c.supportLinearFiltering||v.uniform2f(re.uniforms.dyeTexelSize,1/I,1/P),v.uniform1i(re.uniforms.uVelocity,G.read.attach(0)),v.uniform1i(re.uniforms.uSource,M.read.attach(1)),v.uniform1f(re.uniforms.dissipation,u.DENSITY_DISSIPATION),O(M.write.fbo),M.swap()}(),function(e){u.BLOOM&&function(e,n){if(l.length<2)return;let r=n;v.disable(v.BLEND),Q.bind();let t=u.BLOOM_THRESHOLD*u.BLOOM_SOFT_KNEE+1e-4,i=u.BLOOM_THRESHOLD-t,o=2*t,a=.25/t;v.uniform3f(Q.uniforms.curve,i,o,a),v.uniform1f(Q.uniforms.threshold,u.BLOOM_THRESHOLD),v.uniform1i(Q.uniforms.uTexture,e.attach(0)),v.viewport(0,0,r.width,r.height),O(r.fbo),Z.bind();for(let e=0;e<l.length;e++){let n=l[e];v.uniform2f(Z.uniforms.texelSize,1/r.width,1/r.height),v.uniform1i(Z.uniforms.uTexture,r.attach(0)),v.viewport(0,0,n.width,n.height),O(n.fbo),r=n}v.blendFunc(v.ONE,v.ONE),v.enable(v.BLEND);for(let e=l.length-2;e>=0;e--){let n=l[e];v.uniform2f(Z.uniforms.texelSize,1/r.width,1/r.height),v.uniform1i(Z.uniforms.uTexture,r.attach(0)),v.viewport(0,0,n.width,n.height),O(n.fbo),r=n}v.disable(v.BLEND),ee.bind(),v.uniform2f(ee.uniforms.texelSize,1/r.width,1/r.height),v.uniform1i(ee.uniforms.uTexture,r.attach(0)),v.uniform1f(ee.uniforms.intensity,u.BLOOM_INTENSITY),v.viewport(0,0,n.width,n.height),O(n.fbo)}(M.read,V),null!=e&&u.TRANSPARENT?v.disable(v.BLEND):(v.blendFunc(v.ONE,v.ONE_MINUS_SRC_ALPHA),v.enable(v.BLEND));let n=null==e?v.drawingBufferWidth:I,r=null==e?v.drawingBufferHeight:P;if(v.viewport(0,0,n,r),!u.TRANSPARENT){k.bind();let n=u.BACK_COLOR;v.uniform4f(k.uniforms.color,n.r/255,n.g/255,n.b/255,1),O(e)}if(null==e&&u.TRANSPARENT&&(q.bind(),v.uniform1f(q.uniforms.aspectRatio,i.width/i.height),O(null)),u.SHADING){let e=u.BLOOM?J:j;if(e.bind(),v.uniform2f(e.uniforms.texelSize,1/n,1/r),v.uniform1i(e.uniforms.uTexture,M.read.attach(0)),u.BLOOM){v.uniform1i(e.uniforms.uBloom,V.attach(1)),v.uniform1i(e.uniforms.uDithering,Y.attach(2));let t=de(Y,n,r);v.uniform2f(e.uniforms.ditherScale,t.x,t.y)}}else{let e=u.BLOOM?$:K;if(e.bind(),v.uniform1i(e.uniforms.uTexture,M.read.attach(0)),u.BLOOM){v.uniform1i(e.uniforms.uBloom,V.attach(1)),v.uniform1i(e.uniforms.uDithering,Y.attach(2));let t=de(Y,n,r);v.uniform2f(e.uniforms.ditherScale,t.x,t.y)}}O(e)}(null),requestAnimationFrame(e)}(),o.addEventListener("mousemove",(e=>{const t=a[0],i=e[n],o=e[r];t.moved=t.down,t.dx=5*(i-t.x),t.dy=5*(o-t.y),t.x=i,t.y=o})),o.addEventListener("touchmove",(e=>{const n=e.targetTouches,r=a[0],t=n[0];r.moved=r.down,r.dx=8*(t.clientX-r.x),r.dy=8*(t.clientY-r.y),r.x=t.clientX,r.y=t.clientY}),!1),a[0].down=!0,a[0].color=me()},n=()=>{document.documentElement.classList.remove("scroll-blocked"),document.documentElement.classList.remove("scroll-blocked--reset")},r="preloader",t=()=>"true"===sessionStorage.getItem(r),i=()=>sessionStorage.setItem(r,!0);document.addEventListener("DOMContentLoaded",(()=>{e({trigger:window,xProperty:"clientX",yProperty:"clientY"}),((e=!1)=>{let r=0;const o=document.querySelector(".preloader");if(!o)return n(),null;const u=o.querySelector(".preloader__line"),a=u.querySelector(".preloader__line__runner"),l=o.querySelector(".preloader__button");return e?(v(),null):(setTimeout((()=>{c(20)}),500),{skipPreloader:v,setPreloaderStage:c,removePreloader:s,showPreloaderButton:function(){return i(),gsap.timeline().to(u,{opacity:0,duration:.5}).to(u,{display:"none"}).to(l,{opacity:0,display:"block"}).to(l,{opacity:1,duration:.5})},getIsPreloaded:t,setIsPreloaded:i});function v(){return c(100).add((()=>{s(),n()}))}function c(e){return r+=e,r>100&&(r=100),gsap.timeline().to(a,{transform:`scaleX(${r/100})`,duration:.4})}function s(){return gsap.to(o,{opacity:0,duration:.4,onComplete:()=>{o.remove()}})}})(!0),(()=>{const e=document.querySelectorAll('[data-animation="runner"]');if(!e.length)return;const n=new IntersectionObserver((e=>{e.forEach((e=>{const n=e.target;e.isIntersecting?n.animate():n.stop()}))}));e.forEach((e=>{const{toggleRunner:r}=((e,n,r)=>{const t=20,i=e.querySelector(n),o=i.querySelector(r),{durationDesk:u=t,durationTablet:a=u,durationMobile:l=a,direction:v="left"}=e.dataset;e.classList.add("runner"),"right"===v?e.classList.add("runner--right"):"top"===v?e.classList.add("runner--top"):"bottom"===v&&e.classList.add("runner--bottom"),i.classList.add("runner__wrapper"),o.classList.add("runner__entry");let c,s,f,m=!1,g=1,d=1;const T=new ResizeObserver((([n])=>{clearTimeout(s),s=setTimeout((()=>function(n){const r=function(n){return E()?Math.ceil(e.offsetWidth/n.contentRect.width):Math.ceil(e.offsetHeight/n.contentRect.height)}(n);d===r&&m||(p(r),d=r,m=!0)}(n)),250)}));T.observe(o);const h=new ResizeObserver((([n])=>{clearTimeout(f),f=setTimeout((()=>function(n){const r=function(n){return E()?n.contentRect.width/e.offsetWidth:n.contentRect.height/e.offsetHeight}(n);g!==r&&(function(n){e.style.setProperty("--duration-desk",u*n+"s"),e.style.setProperty("--duration-tablet",a*n+"s"),e.style.setProperty("--duration-mobile",l*n+"s")}(r),g=r)}(n)),250)}));return h.observe(i),{toggleRunner:function(n=!1){n?e.classList.add("runner--visible"):e.classList.remove("runner--visible")},cleanup:function(){T.disconnect(),h.disconnect()}};function E(){return"left"===v||"right"===v}function p(n){if(n>d){const e=n-d;for(let n=0;n<e;n++){const e=o.cloneNode(!0);i.appendChild(e)}}else{const e=d-n;for(let n=0;n<e;n++)i.removeChild(i.lastElementChild)}c&&c.remove(),c=i.cloneNode(!0),i.after(c),e.classList.add("runner--reset"),setTimeout((()=>e.classList.remove("runner--reset")),10)}})(e,'[data-animation="runner-wrapper"]','[data-animation="runner-entry"]');e.animate=()=>r(!0),e.stop=()=>r(!1),n.observe(e)}))})()}))})();